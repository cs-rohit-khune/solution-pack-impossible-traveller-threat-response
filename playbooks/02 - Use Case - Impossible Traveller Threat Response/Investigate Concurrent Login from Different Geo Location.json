{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Investigate Concurrent Login from Different Geo Location",
    "aliasName": null,
    "tag": null,
    "description": "Investigates alerts of type \u2018Concurrent Login\u2019 by checking if the source IP address is in the specified CIDR range, and then performs remediation tasks based on the result.",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "lastModifyDate": 1645129221,
    "collection": "\/api\/3\/workflow_collections\/fded9da7-922f-48e8-aa71-f2d8e577f55b",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/1fa47785-33ac-49fc-9251-7d871f4f938b",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "route": "2f236473-7f06-4a98-9976-4fc66330ef6f",
                "resources": [
                    "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                    "input": {
                        "records": "{{vars.input.records}}"
                    },
                    "alert_metadata": "{{vars.input.records[0].sourcedata | toDict}}"
                },
                "displayConditions": {
                    "alerts": {
                        "sort": [],
                        "limit": 30,
                        "logic": "AND",
                        "filters": [
                            {
                                "type": "object",
                                "field": "type",
                                "value": "\/api\/3\/picklists\/72459a5f-7759-4cff-a8ac-fa673113c4d0",
                                "_value": {
                                    "@id": "\/api\/3\/picklists\/72459a5f-7759-4cff-a8ac-fa673113c4d0",
                                    "display": "Concurrent Login",
                                    "itemValue": "Concurrent Login"
                                },
                                "operator": "eq"
                            }
                        ]
                    }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
            },
            "status": null,
            "top": "30",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
            "uuid": "1fa47785-33ac-49fc-9251-7d871f4f938b"
        },
        {
            "@type": "WorkflowStep",
            "name": "Configurations",
            "description": null,
            "arguments": {
                "destIP": "{{vars.alert_metadata.\nassociated_events.event_details[0][0].attributes.destIpAddr}}",
                "userid": "{{vars.alert_metadata.associated_events.event_details[0][0].attributes.srcUser}}",
                "HrEmail": "hr.dept@example.com",
                "username": "{{vars.alert_metadata.associated_events.event_details[0][0].attributes.userFullName}}",
                "ITdeptEmail": "it.dept@exampl.com",
                "VT_Threshold": "5",
                "useMockOutput": "{{globalVars.Demo_mode}}",
                "rawEventMessage": "DB Login Success",
                "internal_cidr_ranges": "193.200.225.0\/24"
            },
            "status": null,
            "top": "165",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "e59e8da6-8f14-48aa-969e-7c32cfc56ee7"
        },
        {
            "@type": "WorkflowStep",
            "name": "Retrieve Users Details From AD",
            "description": null,
            "arguments": {
                "name": "Active Directory",
                "config": "a5a06e4a-2523-49ef-8afc-b05ba05bf65f",
                "params": {
                    "cookie": "",
                    "page_size": "",
                    "size_limit": "",
                    "search_object": "User",
                    "search_attr_name": "Name",
                    "search_attr_value": "{{vars.userid}}"
                },
                "version": "2.1.1",
                "connector": "activedirectory",
                "operation": "global_search",
                "mock_result": "{\n  \"data\": {\n    \"cookie\": \"\",\n    \"entries\": [\n      {\n        \"dn\": \"CN=Tony Stark,CN=Users,DC=cspune,DC=com\",\n        \"attributes\": {\n          \"c\": \"IN\",\n          \"l\": \"Pune\",\n          \"cn\": \"Tony Stark\",\n          \"co\": \"India\",\n          \"sn\": \"Stark\",\n          \"st\": \"Maharshtra\",\n          \"mail\": \"tonys@outlook.com\",\n          \"name\": \"Tony Stark\",\n          \"title\": \"System Engineer\",\n          \"manager\": \"CN=Bob M,CN=Users,DC=cspune,DC=com\",\n          \"codePage\": 0,\n          \"givenName\": \"Tony\",\n          \"lastLogon\": 1610694904,\n          \"objectSid\": \"S-1-5-21-3252237415-4094437703-262466058-1217\",\n          \"department\": \"IT\",\n          \"lastLogoff\": null,\n          \"logonCount\": 1610694981,\n          \"objectGUID\": \"{99c1d25e-d9f5-4f07-b9bf-ae0b1b4b2e0a}\",\n          \"postalCode\": \"412352\",\n          \"pwdLastSet\": 1603201135,\n          \"uSNChanged\": 100817,\n          \"uSNCreated\": 100808,\n          \"badPwdCount\": 0,\n          \"countryCode\": 356,\n          \"displayName\": \"Tony Stark\",\n          \"objectClass\": [\n            \"top\",\n            \"person\",\n            \"organizationalPerson\",\n            \"user\"\n          ],\n          \"whenChanged\": 1603201241,\n          \"whenCreated\": 1603201135,\n          \"instanceType\": 4,\n          \"accountExpires\": 253402300799,\n          \"objectCategory\": \"CN=Person,CN=Schema,CN=Configuration,DC=cspune,DC=com\",\n          \"primaryGroupID\": 513,\n          \"sAMAccountName\": \"tonys\",\n          \"sAMAccountType\": \"SAM_NORMAL_USER_ACCOUNT\",\n          \"badPasswordTime\": null,\n          \"distinguishedName\": \"CN=Tony Stark,CN=Users,DC=cspune,DC=com\",\n          \"userPrincipalName\": \"example@mail.com\",\n          \"userAccountControl\": \"USER_ACCOUNT_DISABLED | NORMAL_ACCOUNT\",\n          \"dSCorePropagationData\": [\n            1603201135,\n            null\n          ]\n        }\n      }\n    ]\n  },\n  \"status\": \"Success\",\n  \"_status\": true,\n  \"message\": \"\",\n  \"operation\": null,\n  \"request_id\": null\n}",
                "operationTitle": "Global Search",
                "step_variables": {
                    "userEmail": "{{vars.result.data.entries[0].attributes.mail}}",
                    "userLoginTime": "{{vars.result.data.entries[0].attributes.lastLogon}}"
                }
            },
            "status": null,
            "top": "840",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "7cc38277-084e-47b8-a905-8c22feb6f2a7"
        },
        {
            "@type": "WorkflowStep",
            "name": "Notify User Login disable for one hour",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Received approval from IT Team and user account is disabled.\n\nEmail is sent to User with subject \"{{vars.result.subject}}\"",
                    "records": "{{vars.input.records[0]['@id']}}"
                },
                "resource": {
                    "to": "{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.mail}}",
                    "body": "Hi {{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.name}},\n\nWe have observed concurrent login to your account from different geographyical locations\n{% for i in vars.alert_metadata.associated_events.event_details %}\n<li>Location : {{i[0].attributes.srcGeoCountry}}<\/li>\n<li> SourceIP : {{i[0].attributes.srcIpAddr}}<\/li>\n <li>Time : {{i[0].attributes.deviceTime}}\n {%endfor%}\n \n hence we are disabling your account for an hour.Incase of any query Please contact IT Help Desk.\n \n Thank you!",
                    "from": "{{globalVars.Default_Email}}",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "subject": "Account is disable for 1 hour",
                    "__replace": "",
                    "msgDirection": {
                        "id": 278,
                        "@id": "\/api\/3\/picklists\/971d37f3-738a-43e7-93ff-f39c6686e933",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Draft",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/09b97c81-669a-4ac8-8668-920913f3329b",
                        "itemValue": "Draft",
                        "orderIndex": 2
                    }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/communication",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2055",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "bafac9ce-6a70-4f37-b402-1e4b79d1d248"
        },
        {
            "@type": "WorkflowStep",
            "name": "Send Approval for Login Disable",
            "description": null,
            "arguments": {
                "resource": {
                    "method": {
                        "id": 116,
                        "@id": "\/api\/3\/picklists\/7a04788b-5128-4288-a0fc-6e82d18c3b7b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "System",
                        "listName": "\/api\/3\/picklist_names\/d7bdd0ba-d721-4324-bec5-410e23f0f485",
                        "itemValue": "System",
                        "orderIndex": 1
                    },
                    "owners": [
                        "\/api\/3\/teams\/6e569c09-3bd4-40f1-98b0-cc994464c3c5"
                    ],
                    "status": {
                        "id": 207,
                        "@id": "\/api\/3\/picklists\/d26464e0-1df4-46c2-a032-018911ba0c40",
                        "icon": null,
                        "uuid": "d26464e0-1df4-46c2-a032-018911ba0c40",
                        "@type": "Picklist",
                        "color": "#bf9937",
                        "listName": "\/api\/3\/picklist_names\/ce294c1f-9318-425f-9a12-2957292f4cbf",
                        "itemValue": "Pending",
                        "orderIndex": 2
                    },
                    "playbookiri": "api\/3\/workflows\/4719c477-28f5-4d8d-9022-f70fe75ccb3d",
                    "playbookname": "Investigate Concurrent login from different geo location",
                    "playbookuuid": "4719c477-28f5-4d8d-9022-f70fe75ccb3d",
                    "approvaldescription": "Approve user disable operation in active directory -\n{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.name}}\nFound concurrent Login attempt from different geo location"
                },
                "collection": "approvals",
                "step_variables": []
            },
            "status": null,
            "top": "1785",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/6832e556-b9c7-497a-babe-feda3bd27dcg",
            "uuid": "632e9c93-92b9-41b2-8336-306c5a9092d7"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start Investigation",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Investigating Potential {{vars.input.records[0].type.itemValue}}, with following fields of interest:\n{% if vars.input.records[0].domain %}Domain: {{vars.input.records[0].domain -}}{% endif %}\n{% if vars.input.records[0].sourceIp %}SourceIP: {{ vars.input.records[0].sourceIp -}}{% endif %}\n{% if vars.input.records[0].destinationIp %}DestinationIP: {{vars.input.records[0].destinationIp -}}{% endif %}\n{% if vars.input.records[0].fileHash %}File Hash: {{vars.input.records[0].fileHash -}}{% endif %}\n{% if vars.input.records[0].computerName %}ComputerName: {{vars.input.records[0].computerName -}}{% endif %}\n{% if vars.input.records[0].processName %}Process: {{vars.input.records[0].processName -}}{% endif %}\n{% if vars.input.records[0].sourceProcess %}SourceProcess: {{vars.input.records[0].sourceProcess -}}{% endif %}\n<br>\n\nObserved Concurrent Login To Account from Below different Geo Location\n{% for i in vars.alert_metadata.associated_events.event_details %}\n* Location : {{i[0].attributes.srcGeoCountry}}\n* SourceIP : {{i[0].attributes.srcIpAddr}}\n {%endfor%}",
                    "records": ""
                },
                "resource": {
                    "status": {
                        "id": 113,
                        "@id": "\/api\/3\/picklists\/758925e7-629c-46d8-89db-fb36f5fbe88a",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Investigating",
                        "listName": "\/api\/3\/picklist_names\/33e964a9-d607-49f2-813c-7ce46141815a",
                        "itemValue": "Investigating",
                        "orderIndex": 2
                    }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "300",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "uuid": "0adb7c71-b71e-4c66-937c-14b1948fc4b5"
        },
        {
            "@type": "WorkflowStep",
            "name": "Match Source IP in Internal CIDR",
            "description": null,
            "arguments": {
                "name": "CyOps Utilities",
                "params": {
                    "cidr": "{{vars.internal_cidr_ranges}}",
                    "ip_address": "{{vars.item[0].attributes.srcIpAddr}}"
                },
                "version": "3.0.5",
                "for_each": {
                    "item": "{{vars.alert_metadata.associated_events.event_details}}",
                    "condition": ""
                },
                "connector": "cyops_utilities",
                "operation": "ip_cidr_check",
                "operationTitle": "Utils: Is IP in CIDR",
                "step_variables": [],
                "operationOutput": {
                    "matched_ips": [],
                    "unmatched_ips": []
                }
            },
            "status": null,
            "top": "435",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "80bbb30e-e8ee-483c-8ba8-15aa9d2dd5a3"
        },
        {
            "@type": "WorkflowStep",
            "name": "Is Source IP internal",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Internal",
                        "step_iri": "\/api\/3\/workflow_steps\/a4debd70-d2e7-4eb2-9449-8ff53ae01540",
                        "condition": "{{ vars.steps.Match_Source_IP_in_Internal_CIDR.data['matched_cidr_ip']  |  length > 0 }}",
                        "step_name": "Create Note for Internal IP"
                    },
                    {
                        "option": "External",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/0cdefac7-32d5-4d32-b4fb-b3d1b5294125",
                        "step_name": "Create Note for External IP"
                    }
                ]
            },
            "status": null,
            "top": "570",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "uuid": "04d07a7f-2b01-489d-9688-910f309142b9"
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Note for Internal IP",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.alert_metadata.aassociated_events.event_details}}",
                    "__bulk": true,
                    "condition": "",
                    "batch_size": 100
                },
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "[\"{{vars.input.records[0]['@id']}}\"]",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p> Source IP: <strong><\/strong><\/p><li><strong>{{vars.item[0].attributes.srcIpAddr}}<\/strong><\/li> is&nbsp;<span style=\"color: #00ff00;\"><strong>Internal and therfore benign<\/strong><\/span><p><\/p>\n",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "705",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "a4debd70-d2e7-4eb2-9449-8ff53ae01540"
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Note for External IP",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.alert_metadata.associated_events.event_details}}",
                    "__bulk": true,
                    "condition": "",
                    "batch_size": 100
                },
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "[\"{{vars.input.records[0]['@id']}}\"]",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p> <span style=\"font-size: 15px; color: #DE7A13;\" class=\"fa fa-exclamation-triangle\"><\/span>&nbsp;Source IP<strong> {{vars.item[0].attributes.srcIpAddr}} is <\/strong><span style=\"background:#e31b1d; color: #fff;\" class=\"badge badge-pill badge-danger\">External<\/span><\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "705",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "0cdefac7-32d5-4d32-b4fb-b3d1b5294125"
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for User Details",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Below are end user's Detais found on AD :<\/p>\n<ul style=\"list-style-type: square;\">\n<li><strong>Name<\/strong>:&nbsp;{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.name}}<\/li>\n<li><strong>Email Address<\/strong>:&nbsp;{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.mail}}<\/li>\n<li><strong>Manager Name<\/strong>:&nbsp;{{vars.steps.Retrieve_Manager_Email_Address.data.entries[0].attributes.name}}<\/li>\n<li><strong>Manager's Email Address<\/strong>:&nbsp;{{vars.steps.Retrieve_Manager_Email_Address.data.entries[0].attributes.mail}}<\/li><\/ul>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1110",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "de6428da-da97-492a-a8fe-69a277347b88"
        },
        {
            "@type": "WorkflowStep",
            "name": "Retrieve Manager Email Address",
            "description": null,
            "arguments": {
                "name": "Active Directory",
                "config": "598c4c8c-08a8-4491-bcb8-2223cb53fc57",
                "params": {
                    "cookie": "",
                    "page_size": "",
                    "size_limit": "",
                    "search_object": "User",
                    "search_attr_name": "Distinguished Name",
                    "search_attr_value": "{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.manager}}"
                },
                "version": "2.1.1",
                "connector": "activedirectory",
                "operation": "global_search",
                "mock_result": "{\n  \"data\": {\n    \"cookie\": \"\",\n    \"entries\": [\n      {\n        \"dn\": \"CN=Bob M,CN=Users,DC=cspune,DC=com\",\n        \"attributes\": {\n          \"c\": \"IN\",\n          \"l\": \"pune\",\n          \"cn\": \"Bob M\",\n          \"co\": \"India\",\n          \"sn\": \"k\",\n          \"st\": \"MH\",\n          \"info\": \"test\",\n          \"mail\": \"bobm@outlook.com\",\n          \"name\": \"Bob M\",\n          \"mobile\": \"9975865053\",\n          \"manager\": \"CN=Robert Banner,CN=Users,DC=cspune,DC=com\",\n          \"codePage\": 0,\n          \"memberOf\": [\n            \"CN=Remote Management Users,CN=Builtin,DC=cspune,DC=com\",\n            \"CN=Remote Desktop Users,CN=Builtin,DC=cspune,DC=com\",\n            \"CN=Administrators,CN=Builtin,DC=cspune,DC=com\"\n          ],\n          \"givenName\": \"bob\",\n          \"lastLogon\": 1603281092,\n          \"objectSid\": \"S-1-5-21-3252237415-4094437703-262466058-1108\",\n          \"adminCount\": 1,\n          \"lastLogoff\": null,\n          \"logonCount\": 164,\n          \"objectGUID\": \"{e64e35bb-2a69-4405-9f20-c8168cf7366f}\",\n          \"postalCode\": \"411045\",\n          \"pwdLastSet\": 1573025485,\n          \"uSNChanged\": 100806,\n          \"uSNCreated\": 35945,\n          \"badPwdCount\": 0,\n          \"countryCode\": 356,\n          \"displayName\": \"bob m\",\n          \"objectClass\": [\n            \"top\",\n            \"person\",\n            \"organizationalPerson\",\n            \"user\"\n          ],\n          \"whenChanged\": 1603200696,\n          \"whenCreated\": 1573025291,\n          \"instanceType\": 4,\n          \"directReports\": [\n            \"CN=Tony Stark,CN=Users,DC=cspune,DC=com\"\n          ],\n          \"accountExpires\": 253402300799,\n          \"objectCategory\": \"CN=Person,CN=Schema,CN=Configuration,DC=cspune,DC=com\",\n          \"primaryGroupID\": 513,\n          \"sAMAccountName\": \"bob\",\n          \"sAMAccountType\": \"SAM_NORMAL_USER_ACCOUNT\",\n          \"badPasswordTime\": 1601019205,\n          \"distinguishedName\": \"CN=bob m,CN=Users,DC=cspune,DC=com\",\n          \"userPrincipalName\": \"bobm@cspune.com\",\n          \"lastLogonTimestamp\": 1602583384,\n          \"userAccountControl\": \"NORMAL_ACCOUNT | DONT_EXPIRE_PASSWORD\",\n          \"dSCorePropagationData\": [\n            1595571543,\n            1573027969,\n            null\n          ],\n          \"physicalDeliveryOfficeName\": \"Jarvis, pune\",\n          \"msDS-SupportedEncryptionTypes\": 0\n        }\n      }\n    ]\n  },\n  \"status\": \"Success\",\n  \"_status\": true,\n  \"message\": \"\",\n  \"operation\": null,\n  \"request_id\": null\n}",
                "operationTitle": "Global Search",
                "pickFromTenant": false,
                "step_variables": {
                    "manager_email": "{{vars.result.data.entries[0].attributes.email}}"
                }
            },
            "status": null,
            "top": "975",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "55e0d16e-8cf0-408f-a3a7-f679638ef100"
        },
        {
            "@type": "WorkflowStep",
            "name": "Disable User Login",
            "description": null,
            "arguments": {
                "name": "Active Directory",
                "config": "ef96f61a-6f92-4f1c-ad93-e6d1eefc3aba",
                "params": {
                    "search_attr_name": "Email",
                    "search_attr_value": "{{vars.userEmail}}"
                },
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "User {{vars.userid}} Account is Disabled for 1 hour",
                    "records": ""
                },
                "version": "2.1.1",
                "connector": "activedirectory",
                "operation": "disable_user_account",
                "mock_result": "{\n     \"description\": \"Disabled User Account\",\n     \"type\": \"Email\",\n     \"referrals\": \"\",\n     \"dn\": \"CN=Tony Stark,CN=Users,DC=cspune,DC=com\",\n     \"result\": \"Disabled\",\n     \"message\": \"Successful\"\n}",
                "operationTitle": "Disable User Account",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "2190",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "9326ed3e-f6ab-4eed-b708-c5248b7a7f8e"
        },
        {
            "@type": "WorkflowStep",
            "name": "Reset Password",
            "description": null,
            "arguments": {
                "name": "Active Directory",
                "config": "ef96f61a-6f92-4f1c-ad93-e6d1eefc3aba",
                "params": {
                    "new_password": "Demo@1234",
                    "search_attr_name": "Email",
                    "search_attr_value": "{{vars.userEmail}}"
                },
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Reset the User Password after an Hour",
                    "records": "{{vars.input.records[0]['@id']}}"
                },
                "version": "2.1.1",
                "connector": "activedirectory",
                "operation": "reset_password",
                "mock_result": "{\n     \"description\": \"Reset User Password\",\n     \"type\": \"Email\",\n     \"referrals\": \"\",\n     \"dn\": \"CN=Tony Stark,CN=Users,DC=cspune,DC=com\",\n     \"result\": \"Reset Password\",\n     \"message\": \"Successful\"\n}",
                "operationTitle": "Reset Password",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "3000",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "86b49e1d-cb6e-4c99-bba4-49fa12ad22e9"
        },
        {
            "@type": "WorkflowStep",
            "name": "Send Email to Manager and IT",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Notified User, Manager, IT Team about Password Reset though Email, please check communications for more details.",
                    "records": "{{vars.input.records[0]['@id']}}"
                },
                "resource": {
                    "cc": "{{vars.manager_email}}",
                    "to": "{{vars.userEmail}}",
                    "bcc": "{{vars.ITdeptEmail}}",
                    "body": "<p>Hello Team<\/p><\/br>\nWe have observed Multiple Concurrent Login Attempt for User : <b>{{vars.username}}<\/b> and We Reset The password for the user.\n\nThank you.",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "subject": "Notify User, Manager, IT Team about Password Reset",
                    "__replace": "",
                    "msgDirection": {
                        "id": 278,
                        "@id": "\/api\/3\/picklists\/971d37f3-738a-43e7-93ff-f39c6686e933",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Draft",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/09b97c81-669a-4ac8-8668-920913f3329b",
                        "itemValue": "Draft",
                        "orderIndex": 2
                    }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/communication",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "3135",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "fe128993-54a8-431c-b1df-780493335fc8"
        },
        {
            "@type": "WorkflowStep",
            "name": "Check if Approved",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Approved",
                        "step_iri": "\/api\/3\/workflow_steps\/bafac9ce-6a70-4f37-b402-1e4b79d1d248",
                        "condition": "{{ vars.steps.Send_Approval_for_Login_Disable.approved == true }}",
                        "step_name": "Notify User Login disable for one hour"
                    },
                    {
                        "option": "Not Approved",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/9d623831-fa71-43fc-910c-60ac3c683bd6",
                        "step_name": "Add Note for Not Approved"
                    }
                ]
            },
            "status": null,
            "top": "1920",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "uuid": "6c2b4869-99bd-4136-a1a7-ee2be39b26b3"
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for Not Approved",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "**User Not Approved to Disable the {{vars.username}} Login.**",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2055",
            "left": "650",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "9d623831-fa71-43fc-910c-60ac3c683bd6"
        },
        {
            "@type": "WorkflowStep",
            "name": "Search users 4 hours of login data in fortisiem",
            "description": null,
            "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "f3a47c5b-8a10-4dfc-9f30-d09778821e57",
                "params": {
                    "start": 0,
                    "value": 4,
                    "perPage": 50,
                    "rel_time": "Hours",
                    "attribute": [
                        "Destination IP",
                        "Raw Event Log"
                    ],
                    "select_clause": "phRecvTime,reptDevIpAddr,eventType,eventName,srcIpAddr,destIpAddr,user,rawEventMsg",
                    "time_selection": "Relative Time",
                    "raw_event_log_value": "{{vars.rawEventMessage}}",
                    "destination_ip_value": "{{vars.destIP}}"
                },
                "version": "4.1.0",
                "connector": "fortinet-fortisiem",
                "operation": "search_events",
                "mock_result": "{\n  \"data\": {\n    \"@start\": \"0\",\n    \"events\": [\n      {\n        \"id\": \"7574069411033098795\",\n        \"nid\": \"7574069411033098795\",\n        \"index\": \"0\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 17:49:48 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:19:47 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='27.60.168.208' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145187530 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:19:47.530' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T17:49:48+05:30\"\n      },\n      {\n        \"id\": \"7574069411033008504\",\n        \"nid\": \"7574069411033008504\",\n        \"index\": \"1\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 17:48:39 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:18:39 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='37.32.125.134' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145119058 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:18:39.058' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T17:48:39+05:30\"\n      },\n      {\n        \"id\": \"7574069411033098795\",\n        \"nid\": \"7574069411033098795\",\n        \"index\": \"0\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 17:30:48 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:19:47 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='27.60.168.208' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145187530 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:19:47.530' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T17:49:48+05:30\"\n      },\n      {\n        \"id\": \"7574069411033008504\",\n        \"nid\": \"7574069411033008504\",\n        \"index\": \"1\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 17:22:39 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:18:39 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='37.32.125.134' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145119058 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:18:39.058' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T17:22:39+05:30\"\n      },\n      {\n        \"id\": \"7574069411033008504\",\n        \"nid\": \"7574069411033008504\",\n        \"index\": \"1\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 17:05:39 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:18:39 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='37.32.125.134' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145119058 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:18:39.058' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T17:05:39+05:30\"\n      },\n      {\n        \"id\": \"7574069411033008504\",\n        \"nid\": \"7574069411033008504\",\n        \"index\": \"1\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 16:05:39 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:18:39 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='37.32.125.134' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145119058 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:18:39.058' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T16:05:39+05:30\"\n      }\n    ],\n    \"@queryId\": \"690845,1611173376077\",\n    \"@errorCode\": \"0\",\n    \"@totalCount\": \"6\"\n  },\n  \"status\": \"Success\",\n  \"_status\": true,\n  \"message\": \"\",\n  \"operation\": null,\n  \"request_id\": null\n}",
                "operationTitle": "Search Events",
                "pickFromTenant": false,
                "step_variables": {
                    "topFiveEvents": "{{vars.result.data.events[:5]}}"
                }
            },
            "status": null,
            "top": "1245",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "ce8e20f3-21cb-4989-815c-c149da1fe618"
        },
        {
            "@type": "WorkflowStep",
            "name": "Convert CEF to JSON",
            "description": null,
            "arguments": {
                "params": {
                    "cef_input": "{{vars.item.attributes.rawEventMsg}}"
                },
                "version": "3.1.2",
                "for_each": {
                    "item": "{{vars.topFiveEvents}}",
                    "parallel": false,
                    "condition": ""
                },
                "connector": "cyops_utilities",
                "operation": "parse_cef",
                "operationTitle": "FSR: Parse CEF String to JSON.",
                "step_variables": []
            },
            "status": null,
            "top": "1380",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "cea67942-972c-4302-a6c5-2b420f9e4788"
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note to Alert with Searched Data",
            "description": null,
            "arguments": {
                "params": {
                    "data": "{{vars.item.data}}",
                    "display": "Vertical",
                    "styling": false,
                    "template": "Stylized with row selection",
                    "row_fields": ""
                },
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Below are the user's 4 hours of login data,displaying top 5 logs:\n<br>\n\n{%for i in vars.result%}\n{{i.data}}\n {%endfor%}",
                    "records": "{{vars.input.records[0]['@id']}}"
                },
                "version": "3.1.2",
                "for_each": {
                    "item": "{{vars.steps.Convert_CEF_to_JSON}}",
                    "parallel": false,
                    "condition": ""
                },
                "connector": "cyops_utilities",
                "operation": "json_to_html",
                "operationTitle": "Utils: Convert JSON into a HTML Table",
                "step_variables": []
            },
            "status": null,
            "top": "1515",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "c5f5f6f4-c43a-4a79-9908-a89a1138ad8e"
        },
        {
            "@type": "WorkflowStep",
            "name": "Check if Login Attempted in Last 10 Mins",
            "description": null,
            "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "f3a47c5b-8a10-4dfc-9f30-d09778821e57",
                "params": {
                    "start": 0,
                    "value": 10,
                    "perPage": "",
                    "rel_time": "Minutes",
                    "attribute": [
                        "Destination IP",
                        "Raw Event Log"
                    ],
                    "select_clause": "phRecvTime,reptDevIpAddr,eventType,eventName,srcIpAddr,destIpAddr,user,rawEventMsg",
                    "time_selection": "Relative Time",
                    "raw_event_log_value": "{{vars.rawEventMessage}}",
                    "destination_ip_value": "{{vars.destIP}}"
                },
                "version": "4.3.0",
                "connector": "fortinet-fortisiem",
                "operation": "search_events",
                "mock_result": "{\n  \"data\": {\n    \"@start\": \"0\",\n    \"events\": [],\n    \"@queryId\": \"690867,1611177163837\",\n    \"@errorCode\": \"0\",\n    \"@totalCount\": \"0\"\n  },\n  \"status\": \"Success\",\n  \"_status\": true,\n  \"message\": \"\",\n  \"operation\": null,\n  \"request_id\": null\n}",
                "operationTitle": "Search Events",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "2595",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "10b13d5d-bc06-40d5-9e08-6b5b78be642f"
        },
        {
            "@type": "WorkflowStep",
            "name": "Check if Login Attempted",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Yes",
                        "step_iri": "\/api\/3\/workflow_steps\/1ccbb392-989f-4936-a256-049d1b79f0e9",
                        "condition": "{{ vars.steps.Check_if_Login_Attempted_in_Last_10_Mins.data.events | length > 0 }}",
                        "step_name": "Add Note for Login Attempt"
                    },
                    {
                        "option": "No",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/291ca319-5a90-49e2-bf4c-d11dd76162b6",
                        "step_name": "Add note for login is not attempted"
                    }
                ]
            },
            "status": null,
            "top": "2730",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "uuid": "6e082487-144e-47b5-811f-aae103d34c44"
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for Login Attempt",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Observed that login is attempted for last an hour",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2865",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "1ccbb392-989f-4936-a256-049d1b79f0e9"
        },
        {
            "@type": "WorkflowStep",
            "name": "Add note for login is not attempted",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Observed that login is not attempted for last an hour",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2865",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "291ca319-5a90-49e2-bf4c-d11dd76162b6"
        },
        {
            "@type": "WorkflowStep",
            "name": "Wait for 1 hour",
            "description": null,
            "arguments": {
                "delay": {
                    "days": 0,
                    "hours": 1,
                    "weeks": 0,
                    "minutes": 0,
                    "seconds": 0
                }
            },
            "status": null,
            "top": "2460",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/6832e556-b9c7-497a-babe-feda3bd27dbf",
            "uuid": "ded7b5de-784c-4eff-bb42-a88b6339b546"
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for Approval",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Sent Approval Request To **IT Team** to Disable User Account",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1650",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "bdd5b40d-1235-43e9-85dd-12bd1481e379"
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for Pause",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Automation workflow snoozed for an hour, Post that we will query for any successfull login attempt",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2325",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "a4ec3749-0f71-4c2e-9662-9b09b19696e6"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configurations",
            "targetStep": "\/api\/3\/workflow_steps\/e59e8da6-8f14-48aa-969e-7c32cfc56ee7",
            "sourceStep": "\/api\/3\/workflow_steps\/1fa47785-33ac-49fc-9251-7d871f4f938b",
            "label": null,
            "isExecuted": false,
            "uuid": "66ff99c0-614e-4fca-8760-9235d1f09ecc"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Match Source IP in Internal CIDR -> Is Source IP internal",
            "targetStep": "\/api\/3\/workflow_steps\/04d07a7f-2b01-489d-9688-910f309142b9",
            "sourceStep": "\/api\/3\/workflow_steps\/80bbb30e-e8ee-483c-8ba8-15aa9d2dd5a3",
            "label": null,
            "isExecuted": false,
            "uuid": "da3956d8-75a5-4188-ae33-64ea0410f839"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configurations -> Start Investigation",
            "targetStep": "\/api\/3\/workflow_steps\/0adb7c71-b71e-4c66-937c-14b1948fc4b5",
            "sourceStep": "\/api\/3\/workflow_steps\/e59e8da6-8f14-48aa-969e-7c32cfc56ee7",
            "label": null,
            "isExecuted": false,
            "uuid": "c54b0f91-a479-405f-940d-489891e1f2e9"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start Investigation -> Match Source IP in Internal CIDR",
            "targetStep": "\/api\/3\/workflow_steps\/80bbb30e-e8ee-483c-8ba8-15aa9d2dd5a3",
            "sourceStep": "\/api\/3\/workflow_steps\/0adb7c71-b71e-4c66-937c-14b1948fc4b5",
            "label": null,
            "isExecuted": false,
            "uuid": "f383b768-60b4-441d-a7b6-824c16c65acb"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Source IP internal -> Create Note for Internal IP",
            "targetStep": "\/api\/3\/workflow_steps\/a4debd70-d2e7-4eb2-9449-8ff53ae01540",
            "sourceStep": "\/api\/3\/workflow_steps\/04d07a7f-2b01-489d-9688-910f309142b9",
            "label": "Internal",
            "isExecuted": false,
            "uuid": "4cbd9231-f093-4544-b942-6a9f77768450"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Source IP internal -> Create Note for External IP",
            "targetStep": "\/api\/3\/workflow_steps\/0cdefac7-32d5-4d32-b4fb-b3d1b5294125",
            "sourceStep": "\/api\/3\/workflow_steps\/04d07a7f-2b01-489d-9688-910f309142b9",
            "label": "External",
            "isExecuted": false,
            "uuid": "d147f1ea-7641-47c6-955e-7b15ee4b372b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Retrieve Users Details From AD -> Retrieve Manager Email Address",
            "targetStep": "\/api\/3\/workflow_steps\/55e0d16e-8cf0-408f-a3a7-f679638ef100",
            "sourceStep": "\/api\/3\/workflow_steps\/7cc38277-084e-47b8-a905-8c22feb6f2a7",
            "label": null,
            "isExecuted": false,
            "uuid": "25c0e5b3-e0e3-46b9-83ac-46c244edf9b8"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Retrieve Manager Email Address -> Add Note for User Details",
            "targetStep": "\/api\/3\/workflow_steps\/de6428da-da97-492a-a8fe-69a277347b88",
            "sourceStep": "\/api\/3\/workflow_steps\/55e0d16e-8cf0-408f-a3a7-f679638ef100",
            "label": null,
            "isExecuted": false,
            "uuid": "d790e6e3-bd4e-4c49-aab1-21011c2016e2"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Reset Password -> Notify Manager about Password Reset",
            "targetStep": "\/api\/3\/workflow_steps\/fe128993-54a8-431c-b1df-780493335fc8",
            "sourceStep": "\/api\/3\/workflow_steps\/86b49e1d-cb6e-4c99-bba4-49fa12ad22e9",
            "label": null,
            "isExecuted": false,
            "uuid": "84c979f7-f4d1-4f1b-9dc7-16d3f1c0868e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Notify User Login disable for one hour -> Disable User Login",
            "targetStep": "\/api\/3\/workflow_steps\/9326ed3e-f6ab-4eed-b708-c5248b7a7f8e",
            "sourceStep": "\/api\/3\/workflow_steps\/bafac9ce-6a70-4f37-b402-1e4b79d1d248",
            "label": null,
            "isExecuted": false,
            "uuid": "8c19829f-4676-4564-bacc-2e21e30de465"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Send Approval for Login Disable -> Check if Approved",
            "targetStep": "\/api\/3\/workflow_steps\/6c2b4869-99bd-4136-a1a7-ee2be39b26b3",
            "sourceStep": "\/api\/3\/workflow_steps\/632e9c93-92b9-41b2-8336-306c5a9092d7",
            "label": null,
            "isExecuted": false,
            "uuid": "95958e70-4e26-4601-b3dc-2bcdabfa38d9"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check if Approved -> Notify User Login disable for one hour",
            "targetStep": "\/api\/3\/workflow_steps\/bafac9ce-6a70-4f37-b402-1e4b79d1d248",
            "sourceStep": "\/api\/3\/workflow_steps\/6c2b4869-99bd-4136-a1a7-ee2be39b26b3",
            "label": "Approved",
            "isExecuted": false,
            "uuid": "a7cbe2e8-ae9e-4428-ae69-14b148c1ed40"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check if Approved -> Add Note for Not Approved",
            "targetStep": "\/api\/3\/workflow_steps\/9d623831-fa71-43fc-910c-60ac3c683bd6",
            "sourceStep": "\/api\/3\/workflow_steps\/6c2b4869-99bd-4136-a1a7-ee2be39b26b3",
            "label": "Not Approved",
            "isExecuted": false,
            "uuid": "9fe7135e-0796-4e3b-b385-ac23fe2482a1"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create Note for External IP -> Retrieve Users Details From AD",
            "targetStep": "\/api\/3\/workflow_steps\/7cc38277-084e-47b8-a905-8c22feb6f2a7",
            "sourceStep": "\/api\/3\/workflow_steps\/0cdefac7-32d5-4d32-b4fb-b3d1b5294125",
            "label": null,
            "isExecuted": false,
            "uuid": "60104f31-9dae-463f-b3cd-84234f26d895"
        },
        {
            "@type": "WorkflowRoute",
            "name": "convert CEF to json -> Add Note to Alert with searched data",
            "targetStep": "\/api\/3\/workflow_steps\/c5f5f6f4-c43a-4a79-9908-a89a1138ad8e",
            "sourceStep": "\/api\/3\/workflow_steps\/cea67942-972c-4302-a6c5-2b420f9e4788",
            "label": null,
            "isExecuted": false,
            "uuid": "77b56d13-3ca4-4bc5-9d9b-a0fd8c3e4e62"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note for User Details -> searching users 4 hours of login data in fortisiem",
            "targetStep": "\/api\/3\/workflow_steps\/ce8e20f3-21cb-4989-815c-c149da1fe618",
            "sourceStep": "\/api\/3\/workflow_steps\/de6428da-da97-492a-a8fe-69a277347b88",
            "label": null,
            "isExecuted": false,
            "uuid": "3249bf8b-4639-4e63-8651-e3311473980f"
        },
        {
            "@type": "WorkflowRoute",
            "name": "check if Login Attempted in last 10 min -> Check if Login Attempted",
            "targetStep": "\/api\/3\/workflow_steps\/6e082487-144e-47b5-811f-aae103d34c44",
            "sourceStep": "\/api\/3\/workflow_steps\/10b13d5d-bc06-40d5-9e08-6b5b78be642f",
            "label": null,
            "isExecuted": false,
            "uuid": "53d5eefb-2d3a-4d45-9075-022b78490703"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note for Login Attempt -> Reset Password",
            "targetStep": "\/api\/3\/workflow_steps\/86b49e1d-cb6e-4c99-bba4-49fa12ad22e9",
            "sourceStep": "\/api\/3\/workflow_steps\/1ccbb392-989f-4936-a256-049d1b79f0e9",
            "label": null,
            "isExecuted": false,
            "uuid": "8f674b4b-8bd8-4ffc-aa00-8c1c6a865232"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add note for login is not attempted -> Reset Password",
            "targetStep": "\/api\/3\/workflow_steps\/86b49e1d-cb6e-4c99-bba4-49fa12ad22e9",
            "sourceStep": "\/api\/3\/workflow_steps\/291ca319-5a90-49e2-bf4c-d11dd76162b6",
            "label": null,
            "isExecuted": false,
            "uuid": "200988f4-548b-4f3e-a73a-817ded180123"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check if Login Attempted -> Add Note for Login Attempt",
            "targetStep": "\/api\/3\/workflow_steps\/1ccbb392-989f-4936-a256-049d1b79f0e9",
            "sourceStep": "\/api\/3\/workflow_steps\/6e082487-144e-47b5-811f-aae103d34c44",
            "label": "Yes",
            "isExecuted": false,
            "uuid": "e04a1a41-9d3b-411f-9bd2-0377c3339352"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check if Login Attempted -> Add note for login is not attempted",
            "targetStep": "\/api\/3\/workflow_steps\/291ca319-5a90-49e2-bf4c-d11dd76162b6",
            "sourceStep": "\/api\/3\/workflow_steps\/6e082487-144e-47b5-811f-aae103d34c44",
            "label": "No",
            "isExecuted": false,
            "uuid": "877f008b-86e2-4163-9023-31c0be8b8988"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note to Alert with searched data -> Add Note for Approval",
            "targetStep": "\/api\/3\/workflow_steps\/bdd5b40d-1235-43e9-85dd-12bd1481e379",
            "sourceStep": "\/api\/3\/workflow_steps\/c5f5f6f4-c43a-4a79-9908-a89a1138ad8e",
            "label": null,
            "isExecuted": false,
            "uuid": "2436e0d9-6673-4753-a97d-ab732dc1d625"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note for Approval -> Send Approval for Login Disable",
            "targetStep": "\/api\/3\/workflow_steps\/632e9c93-92b9-41b2-8336-306c5a9092d7",
            "sourceStep": "\/api\/3\/workflow_steps\/bdd5b40d-1235-43e9-85dd-12bd1481e379",
            "label": null,
            "isExecuted": false,
            "uuid": "304c15de-5ffd-4e04-83ab-73ef12a573ab"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Disable User Login -> Add note for pause",
            "targetStep": "\/api\/3\/workflow_steps\/a4ec3749-0f71-4c2e-9662-9b09b19696e6",
            "sourceStep": "\/api\/3\/workflow_steps\/9326ed3e-f6ab-4eed-b708-c5248b7a7f8e",
            "label": null,
            "isExecuted": false,
            "uuid": "ca50ce3e-d5fb-4165-9604-9d5af0e929b9"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Search users 4 hours of login data in fortisiem -> convert CEF to json",
            "targetStep": "\/api\/3\/workflow_steps\/cea67942-972c-4302-a6c5-2b420f9e4788",
            "sourceStep": "\/api\/3\/workflow_steps\/ce8e20f3-21cb-4989-815c-c149da1fe618",
            "label": null,
            "isExecuted": false,
            "uuid": "aac6f1e8-fbae-4021-a5c8-37024f8ae751"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note for Pause -> Wait for 1 hour",
            "targetStep": "\/api\/3\/workflow_steps\/ded7b5de-784c-4eff-bb42-a88b6339b546",
            "sourceStep": "\/api\/3\/workflow_steps\/a4ec3749-0f71-4c2e-9662-9b09b19696e6",
            "label": null,
            "isExecuted": false,
            "uuid": "830057ee-963f-47d4-add2-7c5366f0b724"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Wait for 1 hour -> Check if Login Attempted in Last 10 Mins",
            "targetStep": "\/api\/3\/workflow_steps\/10b13d5d-bc06-40d5-9e08-6b5b78be642f",
            "sourceStep": "\/api\/3\/workflow_steps\/ded7b5de-784c-4eff-bb42-a88b6339b546",
            "label": null,
            "isExecuted": false,
            "uuid": "c957841e-b4a5-43e4-8cde-cb0e24554b29"
        }
    ],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "4719c477-28f5-4d8d-9022-f70fe75ccb3d",
    "recordTags": [
        "ManualAction"
    ],
    "id": "542",
    "createUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "createDate": 1645129221.776213,
    "modifyUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "modifyDate": 1645129221.776213,
    "owners": [],
    "isPrivate": false,
    "deletedAt": null
}