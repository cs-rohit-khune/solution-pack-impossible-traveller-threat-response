{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Investigate Concurrent Login from Different Geo Location",
    "aliasName": null,
    "tag": null,
    "description": "Investigates alerts of type \u2018Concurrent Login\u2019 by checking if the source IP address is in the specified CIDR range, and then performs remediation tasks based on the result.",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/fded9da7-922f-48e8-aa71-f2d8e577f55b",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/c974afcc-cd19-4ace-9591-242b20a3c245",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Add Note for Approval",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Sent Approval Request To **IT Team** to Disable User Account",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2440",
            "left": "400",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "9925b96d-5fa8-4986-bb0e-a13dc2536405"
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for Approval to Block IP",
            "description": null,
            "arguments": {
                "resource": {
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Sent approval request to block following IP(s) on FortiGate:<\/p>\n<p>&nbsp;<\/p>\n<p>{{vars.malicious_ip_list | join(\"<br>\")}}<\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1020",
            "left": "760",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "37c03668-f610-463e-855a-36406f4ed38b"
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for Login Attempt",
            "description": null,
            "arguments": {
                "resource": {
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Observed that login is attempted for past 1 hour<\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "3420",
            "left": "360",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "aa87780c-37de-4936-9157-6cc41e9ee8a8"
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for Login is not Attempted",
            "description": null,
            "arguments": {
                "resource": {
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Observed that login is not attempted for past 1 hour<\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "3420",
            "left": "760",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "1a1f372c-109a-4554-9bd0-cfa10fa17a45"
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for Not Approved",
            "description": null,
            "arguments": {
                "resource": {
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>User has not approved to disable the {{vars.username}} login.<\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2700",
            "left": "200",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "3cf49473-8420-4192-b5e2-fa3bdbe0a5e7"
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for Pause",
            "description": null,
            "arguments": {
                "resource": {
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Automation workflow snoozed for an hour, Post that we will query for any successful login attempt<\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2940",
            "left": "560",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "2b0beffc-4880-4aa7-9adf-1d40f87b866f"
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for Request Approved",
            "description": null,
            "arguments": {
                "resource": {
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "content": "<p>Request to block indicators is&nbsp; <span style=\"background: #28B35C; color: #fff;\" class=\"badge badge-success\"> Approved<\/span><\/p>\n<ul>\n<li>Proceeding with block procedure<\/li>\n<\/ul>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1300",
            "left": "940",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "ea2df460-af96-40f3-b6c2-49c4d63e480a"
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for Request Denied",
            "description": null,
            "arguments": {
                "resource": {
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "content": "<p>&nbsp;Request to block indicators is <span class=\"badge badge-success\" style=\"background: #f0a313; color: black;\"> Denied<\/span><\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1300",
            "left": "580",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "ff429e1e-8923-4aa6-8787-de077931cd9b"
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for User Details",
            "description": null,
            "arguments": {
                "resource": {
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Below are end user's details found on AD :<\/p>\n<ul>\n<li><strong>Name<\/strong>:&nbsp;{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.name}}<\/li>\n<li><strong>Email Address<\/strong>:&nbsp;{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.mail}}<\/li>\n<li><strong>Manager Name<\/strong>:&nbsp;{{vars.steps.Retrieve_Manager_Email_Address.data.entries[0].attributes.name}}<\/li>\n<li><strong>Manager's Email Address<\/strong>:&nbsp;{{vars.steps.Retrieve_Manager_Email_Address.data.entries[0].attributes.mail}}<\/li>\n<\/ul>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1760",
            "left": "400",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "40ab7d15-79c6-4a35-85b3-f57f8f358b0f"
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note to Alert with Searched Data",
            "description": null,
            "arguments": {
                "resource": {
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "content": "<p>Here are the user's top 5 login logs from the past 4 hours:<\/p>\n<p>{{vars.steps.Get_User_Login_Summary.data}}<\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2300",
            "left": "400",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "1e4319ca-0089-4673-a45c-611a06ab6426"
        },
        {
            "@type": "WorkflowStep",
            "name": "Approval to Block Malicious IPs",
            "description": null,
            "arguments": {
                "type": "InputBased",
                "input": {
                    "schema": {
                        "title": "Approval - Block Malicious IP Addresses",
                        "description": "<p>Please approve blocking of malicious IP Addresses on FortiGate:-<\/p>\n<br>\n{{vars.malicious_ip_list | join(\"<br>\")}}\n",
                        "inputVariables": []
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "agent_id": null,
                "resources": "alerts",
                "is_approval": true,
                "owner_detail": {
                    "isAssigned": true,
                    "assignedToTeam": [
                        {
                            "iri": "\/api\/3\/teams\/6e569c09-3bd4-40f1-98b0-cc994464c3c5",
                            "teamname": "SOC Team"
                        }
                    ],
                    "assignedToField": null,
                    "emailRecipients": "",
                    "assignedToPerson": [],
                    "assignedToRecord": false
                },
                "isRecordLinked": false,
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "Approve",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/ea2df460-af96-40f3-b6c2-49c4d63e480a"
                        },
                        {
                            "option": "Reject",
                            "primary": false,
                            "step_iri": "\/api\/3\/workflow_steps\/ff429e1e-8923-4aa6-8787-de077931cd9b"
                        }
                    ],
                    "connecteStepsLength": 2,
                    "customSuccessMessage": "Awaiting Playbook resumed successfully."
                },
                "email_notification": {
                    "enabled": false,
                    "smtpParameters": []
                },
                "customEmailExternal": false,
                "inline_channel_list": [],
                "external_channel_list": [],
                "unauthenticated_input": false,
                "external_email_subject": null,
                "internal_email_subject": "A FortiSOAR playbook is requesting your input",
                "custom_email_body_external": null,
                "external_email_attachments": null
            },
            "status": null,
            "top": "1160",
            "left": "760",
            "stepType": "\/api\/3\/workflow_step_types\/a19333c2-c822-11ed-afa1-0242ac120002",
            "group": null,
            "uuid": "ce4d83bd-e2a6-4f1b-aa67-0a47f287f73b"
        },
        {
            "@type": "WorkflowStep",
            "name": "Block Malicious IP Addresses",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.steps.Get_Malicious_Indicators}}",
                    "__bulk": false,
                    "parallel": true,
                    "condition": ""
                },
                "arguments": {
                    "indicatorIRI": "{{vars.item['@id']}}",
                    "indicatorValue": "{{vars.item.value}}"
                },
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": true,
                "pass_input_record": false,
                "workflowReference": "\/api\/3\/workflows\/5b9f90d9-0ae3-4540-ba7f-2b372197677e"
            },
            "status": null,
            "top": "1440",
            "left": "940",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "group": null,
            "uuid": "99c42266-7c52-4d63-afb0-2b2a5bea4984"
        },
        {
            "@type": "WorkflowStep",
            "name": "Check if Login Attempted",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Yes",
                        "step_iri": "\/api\/3\/workflow_steps\/aa87780c-37de-4936-9157-6cc41e9ee8a8",
                        "condition": "{{ vars.steps.Check_if_Login_Attempted_in_Last_10_Mins.data.events | length > 0 }}",
                        "step_name": "Add Note for Login Attempt"
                    },
                    {
                        "option": "No",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/1a1f372c-109a-4554-9bd0-cfa10fa17a45",
                        "step_name": "Add note for login is not attempted"
                    }
                ]
            },
            "status": null,
            "top": "3300",
            "left": "560",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": null,
            "uuid": "6303a433-4caf-41dc-ac39-7efa7f911c7a"
        },
        {
            "@type": "WorkflowStep",
            "name": "Check if Login Attempted in Last 10 Mins",
            "description": null,
            "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "f3a47c5b-8a10-4dfc-9f30-d09778821e57",
                "params": {
                    "start": 0,
                    "value": 10,
                    "perPage": "",
                    "rel_time": "Minutes",
                    "attribute": [
                        "Destination IP",
                        "Raw Event Log"
                    ],
                    "select_clause": "phRecvTime,reptDevIpAddr,eventType,eventName,srcIpAddr,destIpAddr,user,rawEventMsg",
                    "time_selection": "Relative Time",
                    "raw_event_log_value": "{{vars.rawEventMessage}}",
                    "destination_ip_value": "{{vars.destIP}}"
                },
                "version": "4.3.0",
                "connector": "fortinet-fortisiem",
                "operation": "search_events",
                "mock_result": "{\n  \"data\": {\n    \"@start\": \"0\",\n    \"events\": [],\n    \"@queryId\": \"690867,1611177163837\",\n    \"@errorCode\": \"0\",\n    \"@totalCount\": \"0\"\n  },\n  \"status\": \"Success\",\n  \"_status\": true,\n  \"message\": \"\",\n  \"operation\": null,\n  \"request_id\": null\n}",
                "operationTitle": "Search Events",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "3180",
            "left": "560",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": null,
            "uuid": "461e2c8d-92de-4cd6-b24e-46ee71e8a7b1"
        },
        {
            "@type": "WorkflowStep",
            "name": "Configurations",
            "description": null,
            "arguments": {
                "destIP": "{{vars.alert_metadata.\nassociated_events.event_details[0][0].attributes.destIpAddr}}",
                "userid": "{{vars.alert_metadata.associated_events.event_details[0][0].attributes.srcUser}}",
                "HrEmail": "hr.dept@example.com",
                "username": "{{vars.alert_metadata.associated_events.event_details[0][0].attributes.userFullName}}",
                "ITdeptEmail": "it.dept@exampl.com",
                "VT_Threshold": "5",
                "useMockOutput": "{{globalVars.Demo_mode}}",
                "rawEventMessage": "DB Login Success",
                "internal_cidr_ranges": "193.200.225.0\/24"
            },
            "status": null,
            "top": "160",
            "left": "560",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "2f77e4ed-bae5-46f4-a407-033268856a23"
        },
        {
            "@type": "WorkflowStep",
            "name": "Convert CEF to JSON",
            "description": null,
            "arguments": {
                "params": {
                    "cef_input": "{{vars.item.attributes.rawEventMsg}}"
                },
                "version": "3.1.2",
                "for_each": {
                    "item": "{{vars.topFiveEvents}}",
                    "parallel": false,
                    "condition": ""
                },
                "connector": "cyops_utilities",
                "operation": "parse_cef",
                "operationTitle": "FSR: Parse CEF String to JSON.",
                "step_variables": []
            },
            "status": null,
            "top": "2020",
            "left": "400",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "group": null,
            "uuid": "2a06d5a1-28e4-474d-b81b-9c7f0b8d471c"
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Note for External IP",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.alert_metadata.associated_events.event_details}}",
                    "__bulk": false,
                    "parallel": true,
                    "condition": ""
                },
                "resource": {
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "alerts": "[\"{{vars.input.records[0]['@id']}}\"]",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p> <span class=\"fa fa-exclamation-triangle\" style=\"font-size: 15px; color: #DE7A13;\"><\/span>&nbsp;Source IP<strong> {{vars.item[0].attributes.srcIpAddr}} is <\/strong><span class=\"badge badge-pill badge-danger\" style=\"background:#e31b1d; color: #fff;\">External<\/span><\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "705",
            "left": "393",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "eb7b1460-f7e7-42bb-9946-7550eb27759b"
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Note for Internal IP",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.alert_metadata.aassociated_events.event_details}}",
                    "__bulk": true,
                    "condition": "",
                    "batch_size": 100
                },
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "[\"{{vars.input.records[0]['@id']}}\"]",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p> Source IP: <strong><\/strong><\/p><li><strong>{{vars.item[0].attributes.srcIpAddr}}<\/strong><\/li> is&nbsp;<span style=\"color: #00ff00;\"><strong>Internal and therfore benign<\/strong><\/span><p><\/p>\n",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "705",
            "left": "743",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "932f9936-cf2e-4593-8bd7-e8478eb3951a"
        },
        {
            "@type": "WorkflowStep",
            "name": "Disable User Login",
            "description": null,
            "arguments": {
                "name": "Active Directory",
                "config": "ef96f61a-6f92-4f1c-ad93-e6d1eefc3aba",
                "params": {
                    "search_attr_name": "Email",
                    "search_attr_value": "{{vars.userEmail}}"
                },
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>User <strong>{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.name}}({{vars.userid}})<\/strong> account is disabled for 1 hour.<\/p>",
                    "records": "",
                    "parentstepid": "\/api\/3\/workflow_steps\/bafac9ce-6a70-4f37-b402-1e4b79d1d248"
                },
                "version": "2.4.0",
                "connector": "activedirectory",
                "operation": "disable_user_account",
                "mock_result": "{\n     \"description\": \"Disabled User Account\",\n     \"type\": \"Email\",\n     \"referrals\": \"\",\n     \"dn\": \"CN=Tony Stark,CN=Users,DC=cspune,DC=com\",\n     \"result\": \"Disabled\",\n     \"message\": \"Successful\"\n}",
                "operationTitle": "Disable User Account",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "2820",
            "left": "560",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": null,
            "uuid": "5055fbf5-8a5a-4e03-bb4a-7c34ea223753"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Malicious Indicators",
            "description": null,
            "arguments": {
                "query": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "type": "primitive",
                            "field": "alerts.uuid",
                            "value": "{{vars.input.records[0].uuid}}",
                            "operator": "eq",
                            "_operator": "eq"
                        },
                        {
                            "type": "object",
                            "field": "reputation",
                            "value": "\/api\/3\/picklists\/7074e547-7785-4979-be32-c6d0c863e4bd",
                            "_value": {
                                "@id": "\/api\/3\/picklists\/7074e547-7785-4979-be32-c6d0c863e4bd",
                                "display": "Malicious",
                                "itemValue": "Malicious"
                            },
                            "operator": "eq"
                        }
                    ],
                    "__selectFields": [
                        "value"
                    ]
                },
                "module": "indicators?$limit=30&$relationships=true&$fsr_max_relation_count=100",
                "checkboxFields": true,
                "step_variables": {
                    "malicious_ip_list": "{{vars.steps.Get_Malicious_Indicators | json_query(\"[].value\")}}"
                }
            },
            "status": null,
            "top": "840",
            "left": "393",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928770",
            "group": null,
            "uuid": "22b05f01-b835-4736-8386-e6453098393c"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get User Login Summary",
            "description": null,
            "arguments": {
                "params": {
                    "data": "{{vars.steps.Convert_CEF_to_JSON | json_query(\"[].data\")}}",
                    "display": "Horizontal",
                    "styling": false,
                    "template": "Stylized with row selection",
                    "row_fields": "['suser', 'src', 'msg', 'data', 'eventTimeStr', 'DeviceName', 'DeviceVendor', 'DeviceProduct', 'DeviceVersion', 'DeviceSeverity', 'DeviceEventClassID']"
                },
                "version": "3.2.5",
                "connector": "cyops_utilities",
                "operation": "json_to_html",
                "operationTitle": "Utils: Convert JSON into a HTML Table",
                "step_variables": []
            },
            "status": null,
            "top": "2160",
            "left": "400",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "group": null,
            "uuid": "b080295c-7c3a-4537-b7fd-32330c30593e"
        },
        {
            "@type": "WorkflowStep",
            "name": "Is Malicious IOCs Found",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "No",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/78d303bf-fcad-4868-99c4-4feb5cb5587f",
                        "step_name": "Retrieve Users Details From AD"
                    },
                    {
                        "option": "Yes",
                        "step_iri": "\/api\/3\/workflow_steps\/37c03668-f610-463e-855a-36406f4ed38b",
                        "condition": "{{ vars.steps.Get_Malicious_Indicators | length > 0 }}",
                        "step_name": "Add Note for Approval to Block IP"
                    }
                ],
                "step_variables": []
            },
            "status": null,
            "top": "975",
            "left": "393",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": null,
            "uuid": "ccb070a5-9161-406d-92aa-3d5ca4f64aa9"
        },
        {
            "@type": "WorkflowStep",
            "name": "Is Source IP Internal",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Internal",
                        "step_iri": "\/api\/3\/workflow_steps\/932f9936-cf2e-4593-8bd7-e8478eb3951a",
                        "condition": "{{ vars.steps.Match_Source_IP_in_Internal_CIDR.data['matched_cidr_ip']  |  length > 0 }}",
                        "step_name": "Create Note for Internal IP"
                    },
                    {
                        "option": "External",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/eb7b1460-f7e7-42bb-9946-7550eb27759b",
                        "step_name": "Create Note for External IP"
                    }
                ],
                "step_variables": []
            },
            "status": null,
            "top": "560",
            "left": "560",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": null,
            "uuid": "7c37b876-94aa-401b-8298-72e12d81edc0"
        },
        {
            "@type": "WorkflowStep",
            "name": "Match Source IP in Internal CIDR",
            "description": null,
            "arguments": {
                "name": "CyOps Utilities",
                "params": {
                    "cidr": "{{vars.internal_cidr_ranges}}",
                    "ip_address": "{{vars.item[0].attributes.srcIpAddr}}"
                },
                "version": "3.0.5",
                "for_each": {
                    "item": "{{vars.alert_metadata.associated_events.event_details}}",
                    "condition": ""
                },
                "connector": "cyops_utilities",
                "operation": "ip_cidr_check",
                "operationTitle": "Utils: Is IP in CIDR",
                "step_variables": [],
                "operationOutput": {
                    "matched_ips": [],
                    "unmatched_ips": []
                }
            },
            "status": null,
            "top": "440",
            "left": "560",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": null,
            "uuid": "3f87e3de-aa9a-4086-a347-c94936cbc70f"
        },
        {
            "@type": "WorkflowStep",
            "name": "Notify User Login Disable for 1 hour",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Received approval from IT Team and user account is disabled.\n\nEmail is sent to User with subject \"{{vars.result.subject}}\"",
                    "records": "{{vars.input.records[0]['@id']}}",
                    "parentstepid": "\/api\/3\/workflow_steps\/0adb7c71-b71e-4c66-937c-14b1948fc4b5"
                },
                "resource": {
                    "to": "{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.mail}}",
                    "body": "Hi {{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.name}},\n\nWe have observed concurrent login to your account from different geographical locations\n\n{% for i in vars.alert_metadata.associated_events.event_details %}\n<li>Location : {{i[0].attributes.srcGeoCountry}}<\/li>\n<li> SourceIP : {{i[0].attributes.srcIpAddr}}<\/li>\n <li>Time : {{i[0].attributes.deviceTime}}\n {%endfor%}\n \nHence we are disabling your account for an hour. \n\nIn case of any query, please contact IT Help Desk.\n \nThank you!",
                    "from": "{{globalVars.Default_Email}}",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "subject": "Account is disabled for 1 hour",
                    "__replace": "",
                    "msgDirection": "\/api\/3\/picklists\/971d37f3-738a-43e7-93ff-f39c6686e933"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/communication",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2700",
            "left": "560",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "ccd60359-7f57-47e1-a388-89e484a865c4"
        },
        {
            "@type": "WorkflowStep",
            "name": "Notify User Manager and IT Team",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Notified User, Manager and IT Team about Password Reset though Email. Please check communications for more details.<\/p>",
                    "records": "{{vars.input.records[0]['@id']}}",
                    "parentstepid": "\/api\/3\/workflow_steps\/86b49e1d-cb6e-4c99-bba4-49fa12ad22e9"
                },
                "resource": {
                    "cc": "{{vars.manager_email}}",
                    "to": "{{vars.userEmail}}",
                    "bcc": "{{vars.ITdeptEmail}}",
                    "body": "<p>Hello Team<\/p><\/br>\nWe have observed Multiple Concurrent Login Attempt for User : <b>{{vars.username}}<\/b> and reset the password for the user.\n\nThank you.",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "subject": "Notify User, Manager, IT Team about Password Reset",
                    "__replace": "",
                    "msgDirection": "\/api\/3\/picklists\/971d37f3-738a-43e7-93ff-f39c6686e933"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/communication",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "3660",
            "left": "560",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "aab27e74-26ff-4b52-9d57-7f37718f2b51"
        },
        {
            "@type": "WorkflowStep",
            "name": "Reset Password",
            "description": null,
            "arguments": {
                "name": "Active Directory",
                "config": "ef96f61a-6f92-4f1c-ad93-e6d1eefc3aba",
                "params": {
                    "new_password": "Demo@1234",
                    "search_attr_name": "Email",
                    "search_attr_value": "{{vars.userEmail}}"
                },
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>User <strong>{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.name}}({{vars.userid}})<\/strong> password has been reset.<\/p>",
                    "records": "{{vars.input.records[0]['@id']}}",
                    "parentstepid": "\/api\/3\/workflow_steps\/9326ed3e-f6ab-4eed-b708-c5248b7a7f8e"
                },
                "version": "2.4.0",
                "connector": "activedirectory",
                "operation": "reset_password",
                "mock_result": "{\n     \"description\": \"Reset User Password\",\n     \"type\": \"Email\",\n     \"referrals\": \"\",\n     \"dn\": \"CN=Tony Stark,CN=Users,DC=cspune,DC=com\",\n     \"result\": \"Reset Password\",\n     \"message\": \"Successful\"\n}",
                "operationTitle": "Reset Password",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "3540",
            "left": "560",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": null,
            "uuid": "9e7c666a-4fab-4743-93f9-2a2b5bcee28d"
        },
        {
            "@type": "WorkflowStep",
            "name": "Retrieve Manager Email Address",
            "description": null,
            "arguments": {
                "name": "Active Directory",
                "config": "598c4c8c-08a8-4491-bcb8-2223cb53fc57",
                "params": {
                    "cookie": "",
                    "page_size": "",
                    "size_limit": "",
                    "search_object": "User",
                    "search_attr_name": "Distinguished Name",
                    "search_attr_value": "{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.manager}}"
                },
                "version": "2.1.1",
                "connector": "activedirectory",
                "operation": "global_search",
                "mock_result": "{\n  \"data\": {\n    \"cookie\": \"\",\n    \"entries\": [\n      {\n        \"dn\": \"CN=Bob M,CN=Users,DC=cspune,DC=com\",\n        \"attributes\": {\n          \"c\": \"IN\",\n          \"l\": \"pune\",\n          \"cn\": \"Bob M\",\n          \"co\": \"India\",\n          \"sn\": \"k\",\n          \"st\": \"MH\",\n          \"info\": \"test\",\n          \"mail\": \"bobm@outlook.com\",\n          \"name\": \"Bob M\",\n          \"mobile\": \"9975865053\",\n          \"manager\": \"CN=Robert Banner,CN=Users,DC=cspune,DC=com\",\n          \"codePage\": 0,\n          \"memberOf\": [\n            \"CN=Remote Management Users,CN=Builtin,DC=cspune,DC=com\",\n            \"CN=Remote Desktop Users,CN=Builtin,DC=cspune,DC=com\",\n            \"CN=Administrators,CN=Builtin,DC=cspune,DC=com\"\n          ],\n          \"givenName\": \"bob\",\n          \"lastLogon\": 1603281092,\n          \"objectSid\": \"S-1-5-21-3252237415-4094437703-262466058-1108\",\n          \"adminCount\": 1,\n          \"lastLogoff\": null,\n          \"logonCount\": 164,\n          \"objectGUID\": \"{e64e35bb-2a69-4405-9f20-c8168cf7366f}\",\n          \"postalCode\": \"411045\",\n          \"pwdLastSet\": 1573025485,\n          \"uSNChanged\": 100806,\n          \"uSNCreated\": 35945,\n          \"badPwdCount\": 0,\n          \"countryCode\": 356,\n          \"displayName\": \"bob m\",\n          \"objectClass\": [\n            \"top\",\n            \"person\",\n            \"organizationalPerson\",\n            \"user\"\n          ],\n          \"whenChanged\": 1603200696,\n          \"whenCreated\": 1573025291,\n          \"instanceType\": 4,\n          \"directReports\": [\n            \"CN=Tony Stark,CN=Users,DC=cspune,DC=com\"\n          ],\n          \"accountExpires\": 253402300799,\n          \"objectCategory\": \"CN=Person,CN=Schema,CN=Configuration,DC=cspune,DC=com\",\n          \"primaryGroupID\": 513,\n          \"sAMAccountName\": \"bob\",\n          \"sAMAccountType\": \"SAM_NORMAL_USER_ACCOUNT\",\n          \"badPasswordTime\": 1601019205,\n          \"distinguishedName\": \"CN=bob m,CN=Users,DC=cspune,DC=com\",\n          \"userPrincipalName\": \"bobm@cspune.com\",\n          \"lastLogonTimestamp\": 1602583384,\n          \"userAccountControl\": \"NORMAL_ACCOUNT | DONT_EXPIRE_PASSWORD\",\n          \"dSCorePropagationData\": [\n            1595571543,\n            1573027969,\n            null\n          ],\n          \"physicalDeliveryOfficeName\": \"Jarvis, pune\",\n          \"msDS-SupportedEncryptionTypes\": 0\n        }\n      }\n    ]\n  },\n  \"status\": \"Success\",\n  \"_status\": true,\n  \"message\": \"\",\n  \"operation\": null,\n  \"request_id\": null\n}",
                "operationTitle": "Global Search",
                "pickFromTenant": false,
                "step_variables": {
                    "manager_email": "{{vars.result.data.entries[0].attributes.email}}"
                }
            },
            "status": null,
            "top": "1620",
            "left": "400",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": null,
            "uuid": "0a34ba0e-d3bf-48b1-9bfe-67a6f97c03da"
        },
        {
            "@type": "WorkflowStep",
            "name": "Retrieve Users Details From AD",
            "description": null,
            "arguments": {
                "name": "Active Directory",
                "config": "a5a06e4a-2523-49ef-8afc-b05ba05bf65f",
                "params": {
                    "cookie": "",
                    "page_size": "",
                    "size_limit": "",
                    "search_object": "User",
                    "search_attr_name": "Name",
                    "search_attr_value": "{{vars.userid}}"
                },
                "version": "2.1.1",
                "connector": "activedirectory",
                "operation": "global_search",
                "mock_result": "{\n  \"data\": {\n    \"cookie\": \"\",\n    \"entries\": [\n      {\n        \"dn\": \"CN=Tony Stark,CN=Users,DC=cspune,DC=com\",\n        \"attributes\": {\n          \"c\": \"IN\",\n          \"l\": \"Pune\",\n          \"cn\": \"Tony Stark\",\n          \"co\": \"India\",\n          \"sn\": \"Stark\",\n          \"st\": \"Maharshtra\",\n          \"mail\": \"tonys@outlook.com\",\n          \"name\": \"Tony Stark\",\n          \"title\": \"System Engineer\",\n          \"manager\": \"CN=Bob M,CN=Users,DC=cspune,DC=com\",\n          \"codePage\": 0,\n          \"givenName\": \"Tony\",\n          \"lastLogon\": 1610694904,\n          \"objectSid\": \"S-1-5-21-3252237415-4094437703-262466058-1217\",\n          \"department\": \"IT\",\n          \"lastLogoff\": null,\n          \"logonCount\": 1610694981,\n          \"objectGUID\": \"{99c1d25e-d9f5-4f07-b9bf-ae0b1b4b2e0a}\",\n          \"postalCode\": \"412352\",\n          \"pwdLastSet\": 1603201135,\n          \"uSNChanged\": 100817,\n          \"uSNCreated\": 100808,\n          \"badPwdCount\": 0,\n          \"countryCode\": 356,\n          \"displayName\": \"Tony Stark\",\n          \"objectClass\": [\n            \"top\",\n            \"person\",\n            \"organizationalPerson\",\n            \"user\"\n          ],\n          \"whenChanged\": 1603201241,\n          \"whenCreated\": 1603201135,\n          \"instanceType\": 4,\n          \"accountExpires\": 253402300799,\n          \"objectCategory\": \"CN=Person,CN=Schema,CN=Configuration,DC=cspune,DC=com\",\n          \"primaryGroupID\": 513,\n          \"sAMAccountName\": \"tonys\",\n          \"sAMAccountType\": \"SAM_NORMAL_USER_ACCOUNT\",\n          \"badPasswordTime\": null,\n          \"distinguishedName\": \"CN=Tony Stark,CN=Users,DC=cspune,DC=com\",\n          \"userPrincipalName\": \"example@mail.com\",\n          \"userAccountControl\": \"USER_ACCOUNT_DISABLED | NORMAL_ACCOUNT\",\n          \"dSCorePropagationData\": [\n            1603201135,\n            null\n          ]\n        }\n      }\n    ]\n  },\n  \"status\": \"Success\",\n  \"_status\": true,\n  \"message\": \"\",\n  \"operation\": null,\n  \"request_id\": null\n}",
                "operationTitle": "Global Search",
                "step_variables": {
                    "userEmail": "{{vars.result.data.entries[0].attributes.mail}}",
                    "userLoginTime": "{{vars.result.data.entries[0].attributes.lastLogon}}"
                }
            },
            "status": null,
            "top": "1480",
            "left": "400",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": null,
            "uuid": "78d303bf-fcad-4868-99c4-4feb5cb5587f"
        },
        {
            "@type": "WorkflowStep",
            "name": "Search users 4 hours of login data in fortisiem",
            "description": null,
            "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "f3a47c5b-8a10-4dfc-9f30-d09778821e57",
                "params": {
                    "start": 0,
                    "value": 4,
                    "perPage": 50,
                    "rel_time": "Hours",
                    "attribute": [
                        "Destination IP",
                        "Raw Event Log"
                    ],
                    "select_clause": "phRecvTime,reptDevIpAddr,eventType,eventName,srcIpAddr,destIpAddr,user,rawEventMsg",
                    "time_selection": "Relative Time",
                    "raw_event_log_value": "{{vars.rawEventMessage}}",
                    "destination_ip_value": "{{vars.destIP}}"
                },
                "version": "4.1.0",
                "connector": "fortinet-fortisiem",
                "operation": "search_events",
                "mock_result": "{\n  \"data\": {\n    \"@start\": \"0\",\n    \"events\": [\n      {\n        \"id\": \"7574069411033098795\",\n        \"nid\": \"7574069411033098795\",\n        \"index\": \"0\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 17:49:48 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:19:47 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='27.60.168.208' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145187530 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:19:47.530' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T17:49:48+05:30\"\n      },\n      {\n        \"id\": \"7574069411033008504\",\n        \"nid\": \"7574069411033008504\",\n        \"index\": \"1\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 17:48:39 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:18:39 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='37.32.125.134' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145119058 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:18:39.058' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T17:48:39+05:30\"\n      },\n      {\n        \"id\": \"7574069411033098795\",\n        \"nid\": \"7574069411033098795\",\n        \"index\": \"0\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 17:30:48 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:19:47 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='27.60.168.208' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145187530 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:19:47.530' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T17:49:48+05:30\"\n      },\n      {\n        \"id\": \"7574069411033008504\",\n        \"nid\": \"7574069411033008504\",\n        \"index\": \"1\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 17:22:39 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:18:39 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='37.32.125.134' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145119058 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:18:39.058' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T17:22:39+05:30\"\n      },\n      {\n        \"id\": \"7574069411033008504\",\n        \"nid\": \"7574069411033008504\",\n        \"index\": \"1\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 17:05:39 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:18:39 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='37.32.125.134' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145119058 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:18:39.058' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T17:05:39+05:30\"\n      },\n      {\n        \"id\": \"7574069411033008504\",\n        \"nid\": \"7574069411033008504\",\n        \"index\": \"1\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 16:05:39 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:18:39 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='37.32.125.134' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145119058 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:18:39.058' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T16:05:39+05:30\"\n      }\n    ],\n    \"@queryId\": \"690845,1611173376077\",\n    \"@errorCode\": \"0\",\n    \"@totalCount\": \"6\"\n  },\n  \"status\": \"Success\",\n  \"_status\": true,\n  \"message\": \"\",\n  \"operation\": null,\n  \"request_id\": null\n}",
                "operationTitle": "Search Events",
                "pickFromTenant": false,
                "step_variables": {
                    "topFiveEvents": "{{vars.result.data.events[:5]}}"
                }
            },
            "status": null,
            "top": "1880",
            "left": "400",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": null,
            "uuid": "2f847e66-f507-4376-a068-17282e063886"
        },
        {
            "@type": "WorkflowStep",
            "name": "Send Approval for Login Disable",
            "description": null,
            "arguments": {
                "type": "InputBased",
                "input": {
                    "schema": {
                        "title": "Approval - Login Disable - {{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.name}}",
                        "description": "**User Disable Operation Approval in Active Directory - {{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.name}}**<br>\nFound concurrent login attempt from different geo location\n\n{% for i in vars.alert_metadata.associated_events.event_details %} \n{{loop.index}}. Location : {{i[0].attributes.srcGeoCountry}} \n   *  SourceIP : {{i[0].attributes.srcIpAddr}} {%endfor%}",
                        "inputVariables": []
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "agent_id": null,
                "resources": "alerts",
                "is_approval": true,
                "owner_detail": {
                    "isAssigned": true,
                    "assignedToTeam": [
                        {
                            "iri": "\/api\/3\/teams\/6e569c09-3bd4-40f1-98b0-cc994464c3c5",
                            "teamname": "SOC Team"
                        }
                    ],
                    "assignedToField": null,
                    "emailRecipients": "",
                    "assignedToPerson": [],
                    "assignedToRecord": false
                },
                "isRecordLinked": false,
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "Approve",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/ccd60359-7f57-47e1-a388-89e484a865c4"
                        },
                        {
                            "option": "Reject",
                            "primary": false,
                            "step_iri": "\/api\/3\/workflow_steps\/3cf49473-8420-4192-b5e2-fa3bdbe0a5e7"
                        }
                    ],
                    "connecteStepsLength": 2,
                    "customSuccessMessage": "Awaiting Playbook resumed successfully."
                },
                "email_notification": {
                    "enabled": false,
                    "smtpParameters": []
                },
                "customEmailExternal": false,
                "inline_channel_list": [],
                "external_channel_list": [],
                "unauthenticated_input": false,
                "external_email_subject": null,
                "internal_email_subject": "A FortiSOAR playbook is requesting your input",
                "custom_email_body_external": null,
                "external_email_attachments": null
            },
            "status": null,
            "top": "2560",
            "left": "400",
            "stepType": "\/api\/3\/workflow_step_types\/a19333c2-c822-11ed-afa1-0242ac120002",
            "group": null,
            "uuid": "68083d0e-a9f6-47b0-b3e7-5ccc1da94d6f"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "route": "ab5900e8-d875-4453-a6ef-d38ecb386f6f",
                "resources": [
                    "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                    "input": {
                        "records": "{{vars.input.records}}"
                    },
                    "alert_metadata": "{{vars.input.records[0].sourcedata | toDict}}"
                },
                "displayConditions": {
                    "alerts": {
                        "sort": [],
                        "limit": 30,
                        "logic": "AND",
                        "filters": [
                            {
                                "type": "object",
                                "field": "type",
                                "value": "\/api\/3\/picklists\/72459a5f-7759-4cff-a8ac-fa673113c4d0",
                                "_value": {
                                    "@id": "\/api\/3\/picklists\/72459a5f-7759-4cff-a8ac-fa673113c4d0",
                                    "display": "Concurrent Login",
                                    "itemValue": "Concurrent Login"
                                },
                                "operator": "eq"
                            }
                        ]
                    }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
            },
            "status": null,
            "top": "40",
            "left": "560",
            "stepType": "\/api\/3\/workflow_step_types\/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
            "group": null,
            "uuid": "c974afcc-cd19-4ace-9591-242b20a3c245"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start Investigation",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Investigating Potential {{vars.input.records[0].type.itemValue}}, with following fields of interest: <br><br>{% if vars.input.records[0].domain %}<strong>Domain<\/strong>: {{vars.input.records[0].domain -}}<br>{% endif %} {% if vars.input.records[0].sourceIp %}<strong>SourceIP<\/strong>: {{ vars.input.records[0].sourceIp -}}<br>{% endif %} {% if vars.input.records[0].destinationIp %}<strong>DestinationIP<\/strong>: {{vars.input.records[0].destinationIp -}}<br>{% endif %} {% if vars.input.records[0].fileHash %}<strong>File Hash<\/strong>: {{vars.input.records[0].fileHash -}}<br>{% endif %} {% if vars.input.records[0].computerName %}<strong>ComputerName<\/strong>: {{vars.input.records[0].computerName -}}<br>{% endif %} {% if vars.input.records[0].processName %}<strong>Process<\/strong>: {{vars.input.records[0].processName -}}<br>{% endif %} {% if vars.input.records[0].sourceProcess %}<strong>SourceProcess<\/strong>: {{vars.input.records[0].sourceProcess -}}<br>{% endif %} <br>Observed Concurrent Login To Account from Below different Geo Location: {% for i in vars.alert_metadata.associated_events.event_details %}<\/p>\n<ul>\n<li>SourceIP : {{i[0].attributes.srcIpAddr}} -&gt; Location : {{i[0].attributes.srcGeoCountry}}<\/li>\n<\/ul>\n<p>{%endfor%}<\/p>",
                    "records": ""
                },
                "resource": {
                    "status": "\/api\/3\/picklists\/758925e7-629c-46d8-89db-fb36f5fbe88a"
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "300",
            "left": "560",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "066874cb-a700-4701-a75b-52396a2ecf8b"
        },
        {
            "@type": "WorkflowStep",
            "name": "Wait for 1 hour",
            "description": null,
            "arguments": {
                "rule": {
                    "actions": [
                        {
                            "type": "resume_playbook",
                            "enabled": true,
                            "channel_uuid": "e2ce87c2-c55a-11ec-9d64-0242ac120002"
                        }
                    ],
                    "is_active": true,
                    "event_source": "crudhub"
                },
                "type": "TimeBased",
                "delay": {
                    "days": 0,
                    "hours": 1,
                    "weeks": 0,
                    "minutes": 0,
                    "seconds": 0
                }
            },
            "status": null,
            "top": "3060",
            "left": "560",
            "stepType": "\/api\/3\/workflow_step_types\/6832e556-b9c7-497a-babe-feda3bd27dbf",
            "group": null,
            "uuid": "902842a7-631a-4faf-bfc8-135126497354"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Add Note for Approval -> Send Approval for Login Disable",
            "targetStep": "\/api\/3\/workflow_steps\/68083d0e-a9f6-47b0-b3e7-5ccc1da94d6f",
            "sourceStep": "\/api\/3\/workflow_steps\/9925b96d-5fa8-4986-bb0e-a13dc2536405",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "468aa466-8903-4e84-90ad-b002bc9b9bc1"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note for Approval to Block IP -> Approval to Block Malicious IPs",
            "targetStep": "\/api\/3\/workflow_steps\/ce4d83bd-e2a6-4f1b-aa67-0a47f287f73b",
            "sourceStep": "\/api\/3\/workflow_steps\/37c03668-f610-463e-855a-36406f4ed38b",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "0f1d7247-8244-4a23-837a-f553379eeeef"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note for Login Attempt -> Reset Password",
            "targetStep": "\/api\/3\/workflow_steps\/9e7c666a-4fab-4743-93f9-2a2b5bcee28d",
            "sourceStep": "\/api\/3\/workflow_steps\/aa87780c-37de-4936-9157-6cc41e9ee8a8",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "484b959a-4f6c-4259-a8d2-4899ed783727"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add note for login is not attempted -> Reset Password",
            "targetStep": "\/api\/3\/workflow_steps\/9e7c666a-4fab-4743-93f9-2a2b5bcee28d",
            "sourceStep": "\/api\/3\/workflow_steps\/1a1f372c-109a-4554-9bd0-cfa10fa17a45",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "80207c2c-861e-449a-bed5-1a2d021314d8"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note for Pause -> Wait for 1 hour",
            "targetStep": "\/api\/3\/workflow_steps\/902842a7-631a-4faf-bfc8-135126497354",
            "sourceStep": "\/api\/3\/workflow_steps\/2b0beffc-4880-4aa7-9adf-1d40f87b866f",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "fdf56b8e-7b90-423b-b63a-b8ac78c63032"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note for Request Denied -> Retrieve Users Details From AD",
            "targetStep": "\/api\/3\/workflow_steps\/78d303bf-fcad-4868-99c4-4feb5cb5587f",
            "sourceStep": "\/api\/3\/workflow_steps\/ff429e1e-8923-4aa6-8787-de077931cd9b",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "337577a1-4a10-432b-8da2-a666b696ba20"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note for User Details -> searching users 4 hours of login data in fortisiem",
            "targetStep": "\/api\/3\/workflow_steps\/2f847e66-f507-4376-a068-17282e063886",
            "sourceStep": "\/api\/3\/workflow_steps\/40ab7d15-79c6-4a35-85b3-f57f8f358b0f",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "fa198672-2195-49b0-9e1c-a63bed181280"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note to Alert with Searched Data -> vrceate comment",
            "targetStep": "\/api\/3\/workflow_steps\/1e4319ca-0089-4673-a45c-611a06ab6426",
            "sourceStep": "\/api\/3\/workflow_steps\/b080295c-7c3a-4537-b7fd-32330c30593e",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "c3416336-3df3-4c1d-b240-fb4b7a3a98d0"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Not for Request Approved -> Block Malicious IP Addresses",
            "targetStep": "\/api\/3\/workflow_steps\/99c42266-7c52-4d63-afb0-2b2a5bea4984",
            "sourceStep": "\/api\/3\/workflow_steps\/ea2df460-af96-40f3-b6c2-49c4d63e480a",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "59f168a9-10b1-4397-9efe-9c54e8aac544"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Approval to Block Malicious IPs -> Add Note for Request Denied",
            "targetStep": "\/api\/3\/workflow_steps\/ff429e1e-8923-4aa6-8787-de077931cd9b",
            "sourceStep": "\/api\/3\/workflow_steps\/ce4d83bd-e2a6-4f1b-aa67-0a47f287f73b",
            "label": "Reject",
            "isExecuted": false,
            "group": null,
            "uuid": "2cd53cc2-27b5-4c8a-be4b-77231447ecc4"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Approval to Block Malicious IPs -> Add Note for Request Approved",
            "targetStep": "\/api\/3\/workflow_steps\/ea2df460-af96-40f3-b6c2-49c4d63e480a",
            "sourceStep": "\/api\/3\/workflow_steps\/ce4d83bd-e2a6-4f1b-aa67-0a47f287f73b",
            "label": "Approve",
            "isExecuted": false,
            "group": null,
            "uuid": "ea7b9195-8131-42c7-9942-982bcab81424"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Block Malicious IP Addresses -> Retrieve Users Details From AD",
            "targetStep": "\/api\/3\/workflow_steps\/78d303bf-fcad-4868-99c4-4feb5cb5587f",
            "sourceStep": "\/api\/3\/workflow_steps\/99c42266-7c52-4d63-afb0-2b2a5bea4984",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "04d9dc20-032c-40b9-aebc-0f18cae4a760"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check if Login Attempted -> Add Note for Login Attempt",
            "targetStep": "\/api\/3\/workflow_steps\/aa87780c-37de-4936-9157-6cc41e9ee8a8",
            "sourceStep": "\/api\/3\/workflow_steps\/6303a433-4caf-41dc-ac39-7efa7f911c7a",
            "label": "Yes",
            "isExecuted": false,
            "group": null,
            "uuid": "51b5c972-2a0d-4988-8e34-c75ddede1182"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check if Login Attempted -> Add note for login is not attempted",
            "targetStep": "\/api\/3\/workflow_steps\/1a1f372c-109a-4554-9bd0-cfa10fa17a45",
            "sourceStep": "\/api\/3\/workflow_steps\/6303a433-4caf-41dc-ac39-7efa7f911c7a",
            "label": "No",
            "isExecuted": false,
            "group": null,
            "uuid": "7ad8251c-0aaa-4909-87d2-33afb2ccc1c1"
        },
        {
            "@type": "WorkflowRoute",
            "name": "check if Login Attempted in last 10 min -> Check if Login Attempted",
            "targetStep": "\/api\/3\/workflow_steps\/6303a433-4caf-41dc-ac39-7efa7f911c7a",
            "sourceStep": "\/api\/3\/workflow_steps\/461e2c8d-92de-4cd6-b24e-46ee71e8a7b1",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "9fb4d464-565f-47f9-ba53-624245e673f2"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configurations -> Start Investigation",
            "targetStep": "\/api\/3\/workflow_steps\/066874cb-a700-4701-a75b-52396a2ecf8b",
            "sourceStep": "\/api\/3\/workflow_steps\/2f77e4ed-bae5-46f4-a407-033268856a23",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "b6216acd-a5ca-4cac-9b3d-bfb9d1bd1832"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Convert CEF to JSON -> Add Note to Alert with Searched Data",
            "targetStep": "\/api\/3\/workflow_steps\/b080295c-7c3a-4537-b7fd-32330c30593e",
            "sourceStep": "\/api\/3\/workflow_steps\/2a06d5a1-28e4-474d-b81b-9c7f0b8d471c",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "91491049-927f-403d-9692-0c3d407cac47"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create Note for External IP -> Get Malicious Source IPs",
            "targetStep": "\/api\/3\/workflow_steps\/22b05f01-b835-4736-8386-e6453098393c",
            "sourceStep": "\/api\/3\/workflow_steps\/eb7b1460-f7e7-42bb-9946-7550eb27759b",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "22abfd53-2e78-422c-8011-543a30fb7ff8"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Disable User Login -> Add note for pause",
            "targetStep": "\/api\/3\/workflow_steps\/2b0beffc-4880-4aa7-9adf-1d40f87b866f",
            "sourceStep": "\/api\/3\/workflow_steps\/5055fbf5-8a5a-4e03-bb4a-7c34ea223753",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "d144b73c-3f14-40db-bb9c-83c8940823cc"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Malicious Source IPs -> Is Malicious IPs Found",
            "targetStep": "\/api\/3\/workflow_steps\/ccb070a5-9161-406d-92aa-3d5ca4f64aa9",
            "sourceStep": "\/api\/3\/workflow_steps\/22b05f01-b835-4736-8386-e6453098393c",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "33c07c8f-5665-461b-af7b-41a2ea79501d"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Malicious IOCs Found -> Add Note for Approval to Block IP",
            "targetStep": "\/api\/3\/workflow_steps\/37c03668-f610-463e-855a-36406f4ed38b",
            "sourceStep": "\/api\/3\/workflow_steps\/ccb070a5-9161-406d-92aa-3d5ca4f64aa9",
            "label": "Yes",
            "isExecuted": false,
            "group": null,
            "uuid": "9867ee83-7ce4-4e5b-add0-7983f00123e7"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Malicious IPs Found -> Retrieve Users Details From AD",
            "targetStep": "\/api\/3\/workflow_steps\/78d303bf-fcad-4868-99c4-4feb5cb5587f",
            "sourceStep": "\/api\/3\/workflow_steps\/ccb070a5-9161-406d-92aa-3d5ca4f64aa9",
            "label": "No",
            "isExecuted": false,
            "group": null,
            "uuid": "9f4ca838-3bbc-4647-b5f6-581f8ab0b5f9"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Source IP internal -> Create Note for External IP",
            "targetStep": "\/api\/3\/workflow_steps\/eb7b1460-f7e7-42bb-9946-7550eb27759b",
            "sourceStep": "\/api\/3\/workflow_steps\/7c37b876-94aa-401b-8298-72e12d81edc0",
            "label": "External",
            "isExecuted": false,
            "group": null,
            "uuid": "ada28374-44b1-4a3c-b217-fdff3a89e11f"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Source IP internal -> Create Note for Internal IP",
            "targetStep": "\/api\/3\/workflow_steps\/932f9936-cf2e-4593-8bd7-e8478eb3951a",
            "sourceStep": "\/api\/3\/workflow_steps\/7c37b876-94aa-401b-8298-72e12d81edc0",
            "label": "Internal",
            "isExecuted": false,
            "group": null,
            "uuid": "bad3fc06-775f-4139-a617-4adecc61dee6"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Match Source IP in Internal CIDR -> Is Source IP internal",
            "targetStep": "\/api\/3\/workflow_steps\/7c37b876-94aa-401b-8298-72e12d81edc0",
            "sourceStep": "\/api\/3\/workflow_steps\/3f87e3de-aa9a-4086-a347-c94936cbc70f",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "0c2a8633-8d7b-41ef-abd1-08b6809ffb81"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Notify User Login disable for one hour -> Disable User Login",
            "targetStep": "\/api\/3\/workflow_steps\/5055fbf5-8a5a-4e03-bb4a-7c34ea223753",
            "sourceStep": "\/api\/3\/workflow_steps\/ccd60359-7f57-47e1-a388-89e484a865c4",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "9736973c-8ba0-4b79-b086-15e6f21a9337"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Reset Password -> Notify Manager about Password Reset",
            "targetStep": "\/api\/3\/workflow_steps\/aab27e74-26ff-4b52-9d57-7f37718f2b51",
            "sourceStep": "\/api\/3\/workflow_steps\/9e7c666a-4fab-4743-93f9-2a2b5bcee28d",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "85ceee26-991b-4f62-aa11-13023ba724d0"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Retrieve Manager Email Address -> Add Note for User Details",
            "targetStep": "\/api\/3\/workflow_steps\/40ab7d15-79c6-4a35-85b3-f57f8f358b0f",
            "sourceStep": "\/api\/3\/workflow_steps\/0a34ba0e-d3bf-48b1-9bfe-67a6f97c03da",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "60f11bdb-7f00-48ad-8a92-3bb4b8d52746"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Retrieve Users Details From AD -> Retrieve Manager Email Address",
            "targetStep": "\/api\/3\/workflow_steps\/0a34ba0e-d3bf-48b1-9bfe-67a6f97c03da",
            "sourceStep": "\/api\/3\/workflow_steps\/78d303bf-fcad-4868-99c4-4feb5cb5587f",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "1788e38d-ae69-478d-b1d3-96fab79234a3"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Search users 4 hours of login data in fortisiem -> convert CEF to json",
            "targetStep": "\/api\/3\/workflow_steps\/2a06d5a1-28e4-474d-b81b-9c7f0b8d471c",
            "sourceStep": "\/api\/3\/workflow_steps\/2f847e66-f507-4376-a068-17282e063886",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "58120db2-9970-41db-9c23-3578c5d3084e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Send Approval for Login Disable -> Add Note for Not Approved",
            "targetStep": "\/api\/3\/workflow_steps\/3cf49473-8420-4192-b5e2-fa3bdbe0a5e7",
            "sourceStep": "\/api\/3\/workflow_steps\/68083d0e-a9f6-47b0-b3e7-5ccc1da94d6f",
            "label": "Reject",
            "isExecuted": false,
            "group": null,
            "uuid": "f92a20a7-16c9-4ed6-940b-7bbc2ff86775"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Send Approval for Login Disable -> Notify User Login Disable for 1 hour",
            "targetStep": "\/api\/3\/workflow_steps\/ccd60359-7f57-47e1-a388-89e484a865c4",
            "sourceStep": "\/api\/3\/workflow_steps\/68083d0e-a9f6-47b0-b3e7-5ccc1da94d6f",
            "label": "Approve",
            "isExecuted": false,
            "group": null,
            "uuid": "a2a1455f-4831-4212-b295-bbb6d45e2391"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configurations",
            "targetStep": "\/api\/3\/workflow_steps\/2f77e4ed-bae5-46f4-a407-033268856a23",
            "sourceStep": "\/api\/3\/workflow_steps\/c974afcc-cd19-4ace-9591-242b20a3c245",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "bca4e6f7-e388-432e-a2d5-ec166bb39282"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start Investigation -> Match Source IP in Internal CIDR",
            "targetStep": "\/api\/3\/workflow_steps\/3f87e3de-aa9a-4086-a347-c94936cbc70f",
            "sourceStep": "\/api\/3\/workflow_steps\/066874cb-a700-4701-a75b-52396a2ecf8b",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "d69859c3-1b3f-408b-a5d9-7c33efc96b95"
        },
        {
            "@type": "WorkflowRoute",
            "name": "vrceate comment -> Add Note for Approval",
            "targetStep": "\/api\/3\/workflow_steps\/9925b96d-5fa8-4986-bb0e-a13dc2536405",
            "sourceStep": "\/api\/3\/workflow_steps\/1e4319ca-0089-4673-a45c-611a06ab6426",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "6023bc7e-9804-41c1-adfe-72150d9d02e0"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Wait for 1 hour -> Check if Login Attempted in Last 10 Mins",
            "targetStep": "\/api\/3\/workflow_steps\/461e2c8d-92de-4cd6-b24e-46ee71e8a7b1",
            "sourceStep": "\/api\/3\/workflow_steps\/902842a7-631a-4faf-bfc8-135126497354",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "f1065f53-23ee-46fc-806b-262557bbe53d"
        }
    ],
    "groups": [],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "4193b788-f484-4073-864a-0d4ddfe06357",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "ManualAction"
    ]
}